<!doctype html>
<html lang="th">
<head>
<meta charset="utf-8">
<title>‡∏õ.58 ‡∏û‡∏¥‡πÄ‡∏®‡∏©</title>

<style>
/* ===== SCREEN (‡∏°‡∏∑‡∏≠‡∏ñ‡∏∑‡∏≠/‡∏Ñ‡∏≠‡∏°) ===== */
 html, body{
  width: 210mm;
  height: 297mm;
  margin: 0;
  padding: 0;
}

body{
  font-family:"Angsana New", serif;
  font-size:16pt;
  background:#f5f5f5;
}

/* ‡∏Å‡∏•‡πà‡∏≠‡∏á‡∏Å‡∏£‡∏∞‡∏î‡∏≤‡∏© A4 */
.sheet{
  width:210mm;
  background:#fff;
  box-shadow:0 6px 16px rgba(0,0,0,.15);
  padding:0;
}

/* ‚úÖ ‡∏°‡∏∑‡∏≠‡∏ñ‡∏∑‡∏≠: scale ‡πÉ‡∏´‡πâ‡∏û‡∏≠‡∏î‡∏µ‡∏Å‡∏±‡∏ö‡∏à‡∏≠ ‡πÑ‡∏°‡πà‡∏ö‡∏µ‡∏ö‡∏ï‡∏≤‡∏£‡∏≤‡∏á */
@media screen and (max-width: 900px){
  .sheet{
    transform-origin: top center;
    transform: scale(calc((100vw - 28px) / 210mm));
  }
}
  @page{
  size: A4 portrait;
  margin: 18mm;
}

@media print{
  html, body{
    width: 210mm;
    height: 297mm;
    margin: 0 !important;
    padding: 0 !important;
    overflow: hidden !important;
  }

  /* ‚úÖ ‡∏ã‡πà‡∏≠‡∏ô‡∏õ‡∏∏‡πà‡∏° */
  .no-print{
    display:none !important;
  }
}


/* ===== ‡∏ï‡∏≤‡∏£‡∏≤‡∏á ===== */
table{
  width:100%;
  border-collapse:collapse;
  table-layout:fixed;
  border:1.2px solid #999;
}

td{
  padding:2px 6px;
  vertical-align:middle;
}

/* ‡πÄ‡∏™‡πâ‡∏ô‡πÉ‡∏ô‡∏ï‡∏≤‡∏£‡∏≤‡∏á */
.b{ border:0.5px solid #999; }
.bb{ border-bottom:1.2px solid #000; }
.br{ border-right:1.2px solid #000; }

/* ‡∏ï‡∏±‡∏ß‡∏≠‡∏±‡∏Å‡∏©‡∏£ */
.center{ text-align:center; }
.bold{ font-weight:bold; }
.top-title{ font-size:16pt; font-weight:bold; }
.bigtitle{ font-size:24pt; font-weight:bold; }
.small{ font-size:10pt; }

.mt{ margin-top:6mm; }

/* ===== ‡∏õ‡∏∏‡πà‡∏° ===== */
.no-print{ margin:10px; }

 /* ===== BUTTON STYLE ===== */
.btn-export{
  padding:15px 39px;
  margin-right:6px;
  border-radius:20px;
  border:0;
  cursor:pointer;
  font-size:15px;
  font-family:"TH Sarabun New","Kanit",sans-serif;
}
.btn-back{background:#ff8fb1;color:#fff;}
.btn-html{ background:#3416dd; color:#fff; }
.btn-pdf{ background:#a51ee8; color:#fff; }


</style>

</head>
<body>
  <!--  ‡∏õ‡∏∏‡πà‡∏°--) -->
<div class="no-print">
  <button onclick="goBack()" class="btn-export btn-back">
    ‚¨Ö ‡∏Å‡∏•‡∏±‡∏ö‡∏´‡∏ô‡πâ‡∏≤‡πÅ‡∏£‡∏Å
  </button>
  <button onclick="exportHTML()" class="btn-export btn-html">üìÑ Export HTML</button>
  <button onclick="exportPDF()" class="btn-export btn-pdf">üñ® Export PDF</button>
</div>

<div class="page">
  <div class="sheet">
<table>
  <colgroup>
    <col style="width: 160px;">  <!-- ‡∏Ñ‡∏≠‡∏•‡∏±‡∏°‡∏ô‡πå 1: ‡∏ï‡πâ‡∏ô‡∏ó‡∏≤‡∏á -->
    <col style="width: 90px;">   <!-- ‡∏Ñ‡∏≠‡∏•‡∏±‡∏°‡∏ô‡πå 2: ‡∏à‡∏≥‡∏ô‡∏ß‡∏ô -->
    <col style="width: 70px;">   <!-- ‡∏Ñ‡∏≠‡∏•‡∏±‡∏°‡∏ô‡πå 3 -->
    <col style="width: 110px;">  <!-- ‡∏Ñ‡∏≠‡∏•‡∏±‡∏°‡∏ô‡πå 4: ‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó -->
    <col style="width: 70px;">   <!-- ‡∏Ñ‡∏≠‡∏•‡∏±‡∏°‡∏ô‡πå 5 -->
    <col style="width: 100px;">  <!-- ‡∏Ñ‡∏≠‡∏•‡∏±‡∏°‡∏ô‡πå 6 -->
    <col style="width: 100px;">  <!-- ‡∏Ñ‡∏≠‡∏•‡∏±‡∏°‡∏ô‡πå 7 -->
  </colgroup>
  <!-- ‡πÅ‡∏ñ‡∏ß‡∏ö‡∏ô -->
  <tr>
    <td  colspan="7" class="br">‡∏õ.58 ‡∏û‡∏¥‡πÄ‡∏®‡∏©SCB</td>
  </tr>

  <tr>
    <td colspan="7" class="center top-title">
      ‡∏ö‡∏±‡∏ç‡∏ä‡∏µ‡∏£‡∏±‡∏ö-‡∏™‡πà‡∏á‡∏°‡∏≠‡∏ö‡∏ö‡∏£‡∏¥‡∏Å‡∏≤‡∏£ ‡∏ò.‡πÑ‡∏ó‡∏¢‡∏û‡∏≤‡∏ì‡∏¥‡∏ä‡∏¢‡πå‡∏Ø ‡∏õ‡∏£‡∏∞‡∏à‡∏≥‡∏™‡∏≤‡∏¢  ‡∏•‡∏™.‡∏®‡∏õ.‡∏≠‡∏∏‡∏ö‡∏•‡∏£‡∏≤‡∏ä‡∏ò‡∏≤‡∏ô‡∏µ
      <span class="s7"></span>
    </td>
  </tr>

  <tr>
    <td colspan="7" class="14 center">
  ‡∏õ‡∏£‡∏∞‡∏à‡∏≥‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà <span id="day"></span>
  ‡πÄ‡∏î‡∏∑‡∏≠‡∏ô <span id="month"></span>
  ‡∏û.‡∏®. <span id="year"></span>
</td>
  </tr>

  <!-- ‡∏´‡∏±‡∏ß‡∏ï‡∏≤‡∏£‡∏≤‡∏á -->
  <tr>
    <td class="b center bold">‡∏ï‡πâ‡∏ô‡∏ó‡∏≤‡∏á </td>
    <td class="b center bold">‡∏à‡∏≥‡∏ô‡∏ß‡∏ô</td>
    <td class="b center bold"></td>
    <td class="b center bold">‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó</td>
    <td class="b center bold"></td>
    <td class="b center bold" colspan="2">‡∏´‡∏°‡∏≤‡∏¢‡πÄ‡∏•‡∏Ç‡∏õ‡πâ‡∏≤‡∏¢‡∏õ‡∏≤‡∏Å‡∏ñ‡∏∏‡∏á</td>
  </tr>

  <!-- ‡πÅ‡∏ñ‡∏ß‡∏ß‡πà‡∏≤‡∏á 1 -->
  <tr class="fill-row">
  <td class="b">&nbsp;</td>
  <td class="b"></td>
  <td class="b"></td>
  <td class="b"></td>
  <td class="b"></td>
  <td class="b" colspan="2"></td>
</tr>
  <!-- ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£ -->
  <tr>
    <td class="b">‡∏≠‡∏∏‡∏ö‡∏•‡∏£‡∏≤‡∏ä‡∏ò‡∏≤‡∏ô‡∏µ</td>
    <td class="b center" id="scb-ubon"></td>
    <td class="b"></td>
    <td class="b center">SCB</td>
    <td class="b"></td>
    <td class="b center" colspan="2" id="ev1"></td>
  </tr>

  <tr>
    <td class="b">‡∏ß‡∏≤‡∏£‡∏¥‡∏ô‡∏ä‡∏≥‡∏£‡∏≤‡∏ö</td>
    <td class="b center" id="scb-warin"></td>
    <td class="b"></td>
    <td class="b center">SCB</td>
    <td class="b"></td>
    <td class="b center" colspan="2" id="ev2"></td>
  </tr>

  <tr>
    <td class="b">‡∏®‡∏£‡∏µ‡∏™‡∏∞‡πÄ‡∏Å‡∏©</td>
    <td class="b center" id="scb-sisaket"></td>
    <td class="b"></td>
    <td class="b center">SCB</td>
    <td class="b"></td>
    <td class="b center" colspan="2" id="ev3"></td>
  </tr>

  <tr>
    <td class="b">‡∏≠‡∏∏‡∏ó‡∏∏‡∏°‡∏û‡∏£‡∏û‡∏¥‡∏™‡∏±‡∏¢</td>
    <td class="b center" id="scb-uthumphon"></td>
    <td class="b"></td>
    <td class="b center">SCB</td>
    <td class="b"></td>
    <td class="b center" colspan="2" id="ev4"></td>
  </tr>

  <tr>
    <td class="b">‡∏Ç‡∏∏‡∏Ç‡∏±‡∏ô‡∏ò‡πå</td>
    <td class="b center" id="scb-khukhan"></td>
    <td class="b"></td>
    <td class="b center">SCB</td>
    <td class="b"></td>
    <td class="b center" colspan="2" id="ev5"></td>
  </tr>

  <tr>
    <td class="b">‡πÄ‡∏î‡∏ä‡∏≠‡∏∏‡∏î‡∏°</td>
    <td class="b center" id="scb-detudom"></td>
    <td class="b"></td>
    <td class="b center">SCB</td>
    <td class="b"></td>
    <td class="b" colspan="2" id="ev6"></td>
  </tr>

  <tr>
    <td class="b">‡∏¢‡πÇ‡∏™‡∏ò‡∏£</td>
    <td class="b center" id="scb-yasothon"></td>
    <td class="b"></td>
    <td class="b center">SCB</td>
    <td class="b"></td>
    <td class="b" colspan="2" id="ev7"></td>
  </tr>

  <tr>
    <td class="b">‡∏°‡∏´‡∏≤‡∏ä‡∏ô‡∏∞‡∏ä‡∏±‡∏¢</td>
    <td class="b center" id="scb-mahachana"></td>
    <td class="b"></td>
    <td class="b center">SCB</td>
    <td class="b"></td>
    <td class="b" colspan="2" id="ev8"></td>
  </tr>

  <tr>
    <td class="b">‡∏≠‡∏≥‡∏ô‡∏≤‡∏à‡πÄ‡∏à‡∏£‡∏¥‡∏ç</td>
    <td class="b center" id="scb-amnatcharoen"></td>
    <td class="b"></td>
    <td class="b center">SCB</td>
    <td class="b"></td>
    <td class="b" colspan="2" id="ev9"></td>
  </tr>

  <tr>
    <td class="b">‡∏Å‡∏±‡∏ô‡∏ó‡∏£‡∏•‡∏±‡∏Å‡∏©‡πå</td>
    <td class="b center" id="scb-kantharalak"></td>
    <td class="b"></td>
    <td class="b center">SCB</td>
    <td class="b"></td>
    <td class="b" colspan="2" id="ev10"></td>
  </tr>

  <tr>
    <td class="b">‡∏Ñ‡∏ï.‡∏ä‡πà‡∏≠‡∏á‡πÄ‡∏°‡πá‡∏Å</td>
    <td class="b center" id="scb-chongmek"></td>
    <td class="b"></td>
    <td class="b center">SCB</td>
    <td class="b"></td>
    <td class="b" colspan="2" id="ev11"></td>
  </tr>

  <!-- ‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÅ‡∏ñ‡∏ß‡∏ß‡πà‡∏≤‡∏á‡πÉ‡∏´‡πâ‡πÄ‡∏´‡∏°‡∏∑‡∏≠‡∏ô‡∏ï‡πâ‡∏ô‡∏â‡∏ö‡∏±‡∏ö -->
  <tr><td class="b">&nbsp;</td><td class="b"></td><td class="b"></td><td class="b"></td><td class="b"></td><td class="b center" colspan="2" id="ev12"></td></tr>
  <tr><td class="b">&nbsp;</td><td class="b"></td><td class="b"></td><td class="b"></td><td class="b"></td><td class="b" colspan="2"></td></tr>
  <tr><td class="b">&nbsp;</td><td class="b"></td><td class="b"></td><td class="b"></td><td class="b"></td><td class="b" colspan="2"></td></tr>
  <tr><td class="b">&nbsp;</td><td class="b"></td><td class="b"></td><td class="b"></td><td class="b"></td><td class="b" colspan="2"></td></tr>
  <tr><td class="b">&nbsp;</td><td class="b"></td><td class="b"></td><td class="b"></td><td class="b"></td><td class="b" colspan="2"></td></tr>
  <tr><td class="b">&nbsp;</td><td class="b"></td><td class="b"></td><td class="b"></td><td class="b"></td><td class="b" colspan="2"></td></tr>
  <tr><td class="b">&nbsp;</td><td class="b"></td><td class="b"></td><td class="b"></td><td class="b"></td><td class="b" colspan="2"></td></tr>
  <tr><td class="b">&nbsp;</td><td class="b"></td><td class="b"></td><td class="b"></td><td class="b"></td><td class="b" colspan="2"></td></tr>
  <tr><td class="b">&nbsp;</td><td class="b"></td><td class="b"></td><td class="b"></td><td class="b"></td><td class="b" colspan="2"></td></tr>
  <tr><td class="b">&nbsp;</td><td class="b"></td><td class="b"></td><td class="b"></td><td class="b"></td><td class="b" colspan="2"></td></tr>
  <tr><td class="b">&nbsp;</td><td class="b"></td><td class="b"></td><td class="b"></td><td class="b"></td><td class="b" colspan="2"></td></tr>
  
  
  <tr><td class="b">&nbsp;</td><td class="b"></td><td class="b"></td><td class="b"></td><td class="b"></td><td class="b" colspan="2"></td></tr>

  <!-- ‡∏£‡∏ß‡∏° -->
  <tr>
    <td class="b bold">‡∏£‡∏ß‡∏°</td>
    <td class="b center bold" id="scb-sum"></td>
    <td class="b center bold">‡∏ñ‡∏∏‡∏á</td>
    <td class="b"></td>
    <td class="b"></td>
    <td class="b" colspan="2"></td>
  </tr>


<!-- ‡∏•‡∏≤‡∏¢‡πÄ‡∏ã‡πá‡∏ô -->

  <tr>
    <td colspan="7" style="height:20px;"></td>
  </tr>
  <tr>
    <td class="center small" colspan="3">
      <div class="sig-line">‡∏•‡∏á‡∏ä‡∏∑‡πà‡∏≠.....................................‡∏ú‡∏π‡πâ‡∏™‡πà‡∏á‡∏°‡∏≠‡∏ö</div>
      <div></div>
    </td>

    <td></td>

    <td class="center small" colspan="3">
      <div class="sig-line">‡∏•‡∏á‡∏ä‡∏∑‡πà‡∏≠.....................................‡∏ú‡∏π‡πâ‡∏£‡∏±‡∏ö‡∏°‡∏≠‡∏ö</div>
      <div></div>
    </td>
  </tr>
  <tr>
    <td class="center small" colspan="3">
      ‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà <span id="d2-day"></span>
      ‡πÄ‡∏î‡∏∑‡∏≠‡∏ô <span id="d2-month"></span>
      ‡∏û.‡∏®. <span id="d2-year"></span>
      ‡πÄ‡∏ß‡∏•‡∏≤ <span id="d2-time"></span> ‡∏ô.
    </td>

    <td></td>

    <td class="center small" colspan="3">
      ‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà ........ ‡πÄ‡∏î‡∏∑‡∏≠‡∏ô ........ ‡∏û.‡∏®. ........ ‡πÄ‡∏ß‡∏•‡∏≤ ........ ‡∏ô.
    </td>
  </tr>
</table>
</div>
</div>
  <script>
(function setThaiDateTime(){
  const now = new Date();

  const day = now.getDate();
  const monthNames = [
    "‡∏°‡∏Å‡∏£‡∏≤‡∏Ñ‡∏°","‡∏Å‡∏∏‡∏°‡∏†‡∏≤‡∏û‡∏±‡∏ô‡∏ò‡πå","‡∏°‡∏µ‡∏ô‡∏≤‡∏Ñ‡∏°","‡πÄ‡∏°‡∏©‡∏≤‡∏¢‡∏ô",
    "‡∏û‡∏§‡∏©‡∏†‡∏≤‡∏Ñ‡∏°","‡∏°‡∏¥‡∏ñ‡∏∏‡∏ô‡∏≤‡∏¢‡∏ô","‡∏Å‡∏£‡∏Å‡∏é‡∏≤‡∏Ñ‡∏°","‡∏™‡∏¥‡∏á‡∏´‡∏≤‡∏Ñ‡∏°",
    "‡∏Å‡∏±‡∏ô‡∏¢‡∏≤‡∏¢‡∏ô","‡∏ï‡∏∏‡∏•‡∏≤‡∏Ñ‡∏°","‡∏û‡∏§‡∏®‡∏à‡∏¥‡∏Å‡∏≤‡∏¢‡∏ô","‡∏ò‡∏±‡∏ô‡∏ß‡∏≤‡∏Ñ‡∏°"
  ];
  const month = monthNames[now.getMonth()];
  const year = now.getFullYear() + 543;

  const hh = String(now.getHours()).padStart(2,"0");
  const mm = String(now.getMinutes()).padStart(2,"0");
  const time = `${hh}:${mm}`;

  const d = document.getElementById("d2-day");
  const m = document.getElementById("d2-month");
  const y = document.getElementById("d2-year");
  const t = document.getElementById("d2-time");

  if(d) d.textContent = day;
  if(m) m.textContent = month;
  if(y) y.textContent = year;
  if(t) t.textContent = time;
})();
</script>
  <script>
(function setThaiDate(){
  const now = new Date();

  const day = now.getDate();
  const monthNames = [
    "‡∏°‡∏Å‡∏£‡∏≤‡∏Ñ‡∏°","‡∏Å‡∏∏‡∏°‡∏†‡∏≤‡∏û‡∏±‡∏ô‡∏ò‡πå","‡∏°‡∏µ‡∏ô‡∏≤‡∏Ñ‡∏°","‡πÄ‡∏°‡∏©‡∏≤‡∏¢‡∏ô",
    "‡∏û‡∏§‡∏©‡∏†‡∏≤‡∏Ñ‡∏°","‡∏°‡∏¥‡∏ñ‡∏∏‡∏ô‡∏≤‡∏¢‡∏ô","‡∏Å‡∏£‡∏Å‡∏é‡∏≤‡∏Ñ‡∏°","‡∏™‡∏¥‡∏á‡∏´‡∏≤‡∏Ñ‡∏°",
    "‡∏Å‡∏±‡∏ô‡∏¢‡∏≤‡∏¢‡∏ô","‡∏ï‡∏∏‡∏•‡∏≤‡∏Ñ‡∏°","‡∏û‡∏§‡∏®‡∏à‡∏¥‡∏Å‡∏≤‡∏¢‡∏ô","‡∏ò‡∏±‡∏ô‡∏ß‡∏≤‡∏Ñ‡∏°"
  ];
  const month = monthNames[now.getMonth()];
  const year = now.getFullYear() + 543;

  const d = document.getElementById("day");
  const m = document.getElementById("month");
  const y = document.getElementById("year");

  if(d) d.textContent = day;
  if(m) m.textContent = month;
  if(y) y.textContent = year;
})();
</script>
  
  <script>
function goHome(){
  // ‚úÖ ‡∏ñ‡πâ‡∏≤‡∏°‡∏µ history ‡πÉ‡∏´‡πâ‡∏Å‡∏•‡∏±‡∏ö‡∏Å‡πà‡∏≠‡∏ô (‡πÉ‡∏ä‡πâ‡∏Å‡∏±‡∏ö PWA ‡πÑ‡∏î‡πâ‡∏î‡∏µ)
  if (history.length > 1) {
    history.back();
    return;
  }
  // ‚úÖ fallback ‡πÑ‡∏õ‡∏´‡∏ô‡πâ‡∏≤‡πÅ‡∏£‡∏Å‡πÅ‡∏ö‡∏ö‡∏ä‡∏±‡∏ß‡∏£‡πå
  location.href = "./index.html";
}
</script>
   <script>
function exportHTML(){
  const sheet = document.querySelector(".sheet");
  if(!sheet){
    alert("‡πÑ‡∏°‡πà‡∏û‡∏ö .sheet ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö Export HTML");
    return;
  }

  const css = document.querySelector("style")?.innerHTML || "";

  const html = `<!doctype html>
<html lang="th">
<head>
<meta charset="utf-8">
<title>SCB Export</title>
<style>${css}</style>
</head>
<body>
<div class="page">
  ${sheet.outerHTML}
</div>
</body>
</html>`;

  // ‚úÖ ‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡∏ä‡∏∑‡πà‡∏≠‡πÑ‡∏ü‡∏•‡πå‡∏≠‡∏±‡∏ï‡πÇ‡∏ô‡∏°‡∏±‡∏ï‡∏¥
  const now = new Date();
  const yyyy = now.getFullYear(); // ‡∏ñ‡πâ‡∏≤‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£ ‡∏û.‡∏®. ‡πÉ‡∏´‡πâ +543
  const mm = String(now.getMonth() + 1).padStart(2, "0");
  const dd = String(now.getDate()).padStart(2, "0");
  const dateStr = `${yyyy}-${mm}-${dd}`; // 2026-01-23

  const blob = new Blob([html], {type:"text/html;charset=utf-8"});
  const url = URL.createObjectURL(blob);

  const a = document.createElement("a");
  a.href = url;
  a.download = `SCB-${dateStr}.html`;   // ‚úÖ ‡∏ä‡∏∑‡πà‡∏≠‡πÑ‡∏ü‡∏•‡πå‡∏°‡∏µ‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà
  a.click();

  URL.revokeObjectURL(url);
}

function exportPDF(){
  window.print();
}
</script>

  <script>
if ("serviceWorker" in navigator) {
  window.addEventListener("load", async () => {
    const reg = await navigator.serviceWorker.register("./service-worker.js");
    reg.update();
  });
}
</script>
  <script>
(function autoScaleA4(){
  const SHEET_SELECTOR = ".sheet";

  // ‡∏Ç‡∏ô‡∏≤‡∏î‡∏Å‡∏£‡∏∞‡∏î‡∏≤‡∏© A4 (px) ‡∏ì ‡∏ï‡∏≠‡∏ô print: ‡πÉ‡∏ä‡πâ CSS inches ‚Üí px ‡∏à‡∏∞‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì‡πÄ‡∏≠‡∏á
  // ‡πÅ‡∏ï‡πà‡πÄ‡∏£‡∏≤‡∏à‡∏∞‡∏Ñ‡∏∏‡∏°‡∏î‡πâ‡∏ß‡∏¢ "‡∏≠‡∏±‡∏ï‡∏£‡∏≤‡∏™‡πà‡∏ß‡∏ô" ‡∏à‡∏≤‡∏Å DOM size ‡∏à‡∏£‡∏¥‡∏á‡πÅ‡∏ó‡∏ô
  function computeScale(){
    const sheet = document.querySelector(SHEET_SELECTOR);
    if(!sheet) return 1;

    // ‡∏Ç‡∏ô‡∏≤‡∏î‡∏û‡∏∑‡πâ‡∏ô‡∏ó‡∏µ‡πà‡∏Å‡∏£‡∏∞‡∏î‡∏≤‡∏© A4 ‡πÉ‡∏ô‡∏´‡∏ô‡πà‡∏ß‡∏¢ px (‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì‡∏à‡∏≤‡∏Å 210mm x 297mm)
    // 1 inch = 25.4mm, 1 inch = 96px (‡∏°‡∏≤‡∏ï‡∏£‡∏ê‡∏≤‡∏ô browser)
    const A4_W = (210 / 25.4) * 96;
    const A4_H = (297 / 25.4) * 96;

    // ‡∏Ç‡∏ô‡∏≤‡∏î‡∏à‡∏£‡∏¥‡∏á‡∏Ç‡∏≠‡∏á sheet ‡∏ö‡∏ô‡∏´‡∏ô‡πâ‡∏≤‡∏à‡∏≠
    const rect = sheet.getBoundingClientRect();
    const w = rect.width;
    const h = rect.height;

    // scale ‡∏ó‡∏µ‡πà‡∏ó‡∏≥‡πÉ‡∏´‡πâ‡∏û‡∏≠‡∏î‡∏µ‡∏ó‡∏±‡πâ‡∏á‡∏Å‡∏ß‡πâ‡∏≤‡∏á‡πÅ‡∏•‡∏∞‡∏™‡∏π‡∏á (‡πÑ‡∏°‡πà‡πÄ‡∏Å‡∏¥‡∏ô 1 ‡∏´‡∏ô‡πâ‡∏≤)
    let scale = Math.min(A4_W / w, A4_H / h);

    // ‡∏Å‡∏±‡∏ô‡πÄ‡∏•‡∏∑‡πà‡∏≠‡∏ô‡∏ô‡∏¥‡∏î‡πÜ
    scale *= 0.995;

    // ‡∏à‡∏≥‡∏Å‡∏±‡∏î‡∏ä‡πà‡∏ß‡∏á‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÑ‡∏°‡πà‡πÉ‡∏´‡πâ‡πÄ‡∏û‡∏µ‡πâ‡∏¢‡∏ô
    if(scale > 1) scale = 1;
    if(scale < 0.6) scale = 0.6;

    return scale;
  }

  function applyScale(){
    const sheet = document.querySelector(SHEET_SELECTOR);
    if(!sheet) return;

    // reset ‡∏Å‡πà‡∏≠‡∏ô‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì
    sheet.style.transform = "none";

    // ‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì‡∏´‡∏•‡∏±‡∏á layout update
    requestAnimationFrame(() => {
      const scale = computeScale();
      sheet.style.transform = `scale(${scale})`;

      // ‡∏õ‡πâ‡∏≠‡∏á‡∏Å‡∏±‡∏ô‡πÇ‡∏î‡∏ô margin/padding ‡∏ó‡∏≥‡πÉ‡∏´‡πâ‡∏•‡πâ‡∏ô
      sheet.style.margin = "0";
    });
  }

  // ‡∏Å‡πà‡∏≠‡∏ô‡∏û‡∏¥‡∏°‡∏û‡πå
  window.addEventListener("beforeprint", applyScale);

  // ‡∏´‡∏•‡∏±‡∏á‡∏û‡∏¥‡∏°‡∏û‡πå ‡∏Å‡∏•‡∏±‡∏ö‡∏™‡∏π‡πà‡∏õ‡∏Å‡∏ï‡∏¥
  window.addEventListener("afterprint", () => {
    const sheet = document.querySelector(SHEET_SELECTOR);
    if(sheet){
      sheet.style.transform = "none";
    }
  });
})();
</script>
 <script>
/* ===== ‡πÇ‡∏´‡∏•‡∏î EV ‡∏à‡∏≤‡∏Å‡∏´‡∏ô‡πâ‡∏≤‡πÅ‡∏£‡∏Å ===== */
const scanEV = JSON.parse(localStorage.getItem("scan-EV") || "[]");

/* ===== COUNTIF ‡πÅ‡∏ö‡∏ö Google Sheets: *xxx* ===== */
function COUNTIF(arr, pattern){
  const escaped = String(pattern)
    .replace(/[.+?^${}()|[\]\\]/g, "\\$&")
    .replace(/\*/g, ".*");
  const re = new RegExp("^" + escaped + "$");
  return arr.filter(v => re.test(String(v || ""))).length;
}

/* ===== ‡πÄ‡∏ï‡∏¥‡∏°‡∏Ñ‡πà‡∏≤‡∏•‡∏á‡∏ä‡πà‡∏≠‡∏á‡∏ó‡∏µ‡πà‡∏°‡∏µ id ===== */
function applyFormulas(){

  // (‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á) ‡πÄ‡∏ó‡∏µ‡∏¢‡∏ö =INDEX!EV1
  const ev1 = document.getElementById("show-ev1");
  if(ev1) ev1.textContent = scanEV[0] || "";

  // COUNTIF ‡πÅ‡∏ï‡πà‡∏•‡∏∞‡∏™‡∏≤‡∏Ç‡∏≤
  const FORMULAS = {
    "scb-ubon":         () => COUNTIF(scanEV, "*3400034010*"),
    "scb-warin":        () => COUNTIF(scanEV, "*3419034010*"),
    "scb-sisaket":      () => COUNTIF(scanEV, "*3300034010*"),
    "scb-uthumphon":    () => COUNTIF(scanEV, "*3312034010*"),
    "scb-khukhan":      () => COUNTIF(scanEV, "*3314034010*"),
    "scb-detudom":      () => COUNTIF(scanEV, "*3416034010*"),
    "scb-yasothon":     () => COUNTIF(scanEV, "*3500034010*"),
    "scb-mahachana":    () => COUNTIF(scanEV, "*3513034010*"),
    "scb-amnatcharoen": () => COUNTIF(scanEV, "*3700034010*"),
    "scb-kantharalak":  () => COUNTIF(scanEV, "*3311034010*"),
    "scb-chongmek":     () => COUNTIF(scanEV, "*0007434010*"),
  };

  // ‡πÉ‡∏™‡πà‡∏Ñ‡πà‡∏≤‡∏ó‡∏µ‡∏•‡∏∞‡∏ä‡πà‡∏≠‡∏á
  Object.entries(FORMULAS).forEach(([id, fn])=>{
    const el = document.getElementById(id);
    if(!el) return;
    const value = fn();
    el.textContent = value ? value : "";
  });

  // ‡∏£‡∏ß‡∏°
  const sumEl = document.getElementById("scb-sum");
  if(sumEl){
    let sum = 0;
    Object.values(FORMULAS).forEach(fn => sum += fn());
    sumEl.textContent = sum ? sum : "";
  }
}

document.addEventListener("DOMContentLoaded", applyFormulas);
</script>

  <script>
if ("serviceWorker" in navigator) {
  window.addEventListener("load", async () => {
    const reg = await navigator.serviceWorker.register("./service-worker.js");
    reg.update();
  });
}
</script>
  <script>

function fillEV_1_to_15(){
  for(let i=1; i<=15; i++){
    const el = document.getElementById("ev" + i);
    if(!el) continue;

    // EV1 ‡∏Ñ‡∏∑‡∏≠ index 0, EV2 index 1 ...
    el.textContent = scanEV[i-1] || "";
  }
}

document.addEventListener("DOMContentLoaded", fillEV_1_to_15);
</script>
  
  <script>
function goBack(){
  if (window.history.length > 1) {
    window.history.back();   // ‚úÖ ‡∏Å‡∏•‡∏±‡∏ö‡πÑ‡∏õ‡∏´‡∏ô‡πâ‡∏≤ index ‡∏ó‡∏µ‡πà‡πÄ‡∏õ‡∏¥‡∏î‡∏°‡∏≤
  } else {
    window.location.replace("/");
  }
}
</script>

</body>
</html>